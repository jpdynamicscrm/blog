<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>クラウド フローで Microsoft Purview の監査ログを取得する方法 | Japan Dynamics CRM &amp; Power Platform Support Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="こんにちは、Power Platform サポートの清水です。今回は、よくお問い合わせをいただく題材の一つとして、クラウド フローを使用して、Microsoft Purview の監査ログを取得する方法について紹介します。   2023 年 10 月現時点では、監査ログを取得できるようなコネクタ・アクションは存在しないため、監査ログを取得するには、Office 365 Management API">
<meta property="og:type" content="article">
<meta property="og:title" content="クラウド フローで Microsoft Purview の監査ログを取得する方法">
<meta property="og:url" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/index.html">
<meta property="og:site_name" content="Japan Dynamics CRM &amp; Power Platform Support Blog">
<meta property="og:description" content="こんにちは、Power Platform サポートの清水です。今回は、よくお問い合わせをいただく題材の一つとして、クラウド フローを使用して、Microsoft Purview の監査ログを取得する方法について紹介します。   2023 年 10 月現時点では、監査ログを取得できるようなコネクタ・アクションは存在しないため、監査ログを取得するには、Office 365 Management API">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/enrolled-app-property.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/secret.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/trigger.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-tenantid.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-clientid.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-secret.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-endpoint.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-contenttype.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/http-list-subscriptions.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/http-list-subscriptions-result.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/filter-array.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/condition.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/http-start-subscription.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-startTime.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-endTime.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-contents.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-contentsAll.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/init-variable-contentslisturi.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/dountil.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/http-content.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/http-content-result.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/apply-to-each.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/http-contents.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/set-variable-contents.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/set-variable-contentsall.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/condition2.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/set-variable-nextpageuri.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/set-variable-no-nextpageuri.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/create-csv-table.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/create-file.png">
<meta property="og:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/flow.png">
<meta property="article:published_time" content="2023-11-13T07:00:00.000Z">
<meta property="article:modified_time" content="2026-02-20T00:55:29.111Z">
<meta property="article:author" content="Japan Dynamics CRM &amp; Power Platform Support Team">
<meta property="article:tag" content="Power Automate">
<meta property="article:tag" content="Cloud flow">
<meta property="article:tag" content="Office 365 Management API">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/enrolled-app-property.png">
  
    <link rel="alternate" href="../../atom.xml" title="Japan Dynamics CRM &amp; Power Platform Support Blog" type="application/atom+xml">
  

  <link rel="icon" href="../../favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
  <link rel="manifest" href="../../site.webmanifest">
  <link rel="mask-icon" href="../../safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="../../css/style.css">

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="site-header-logo"></div>
  <div id="site-header-blog-wrapper"></div>
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        <div id="ms-logo"></div>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
        <a class="main-nav-link" target="_blank" rel="noopener" href="https://cssjpn.github.io/">サポート情報</a>
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="../../atom.xml" title="RSSフィード"></a>
        
      </nav>
      <div id="search-form-wrap">
        <form action="//www.bing.com/search" method="get" accept-charset="UTF-8" name="bing-search" onsubmit="var f=this;if(f['q'].value){var searchUrl =  'https://www.bing.com/search?q=' +  encodeURIComponent(f['q'].value + ' site:' + f['sitesearch'].value) ;window.open(searchUrl, 'blank') };return false;" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="検索"><button type="submit" id="nav-search-btn" class="search-form-submit"></button><input type="hidden" name="sitesearch" value="https://jpdynamicscrm.github.io/blog"></form>
      </div>
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../index.html" id="logo">Japan Dynamics CRM &amp; Power Platform Support Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="../../index.html" id="subtitle">日本マイクロソフトの Dynamics CRM &amp; Power Platform テクニカル サポート チームより、情報をお届けします！</a>
        </h2>
      
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-powerautomate/work-with-audit-log" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header-single">
        
  
    <h1 class="article-title" itemprop="name">
      クラウド フローで Microsoft Purview の監査ログを取得する方法
    </h1>
  

      </header>
      <div class="article-share">
        Published: 
        <a href="" class="article-date-single">
  <time datetime="2023-11-13T07:00:00.000Z" itemprop="datePublished">2023-11-13</time>
</a>
        
          / Last update: <a id="update-time" class="article-date-single"></a>
/ Contributors: <ul style="display: inline-block; list-style:none" id="contributors" class="github-contributors"> </ul>

<script type="text/javascript">
  const sourceUrl = "https://github.com/jpdynamicscrm/blog/blob/master/articles/powerautomate/work-with-audit-log.md";
  const urlParts = sourceUrl.split("/");
  const user = urlParts[3];
  const repo = urlParts[4];
  const filePath = urlParts.slice(7).join("/");
  const apiUrl = `https://api.github.com/repos/${user}/${repo}/commits?path=${filePath}`;
  function formatDate(date) {
    let year = date.getFullYear();
    let month = date.getMonth() + 1;
    let day = date.getDate();

    if (month < 10) {
      month = '0' + month;
    }
    if (day < 10) {
      day = '0' + day;
    }

    return year + '-' + month + '-' + day;
  }

  $.getJSON(apiUrl, function (data) {
    const commit = data[0];
    const updateDate = new Date(commit.commit.author.date);
    const localDate = formatDate(updateDate);
    const contributors = new Map();

    data.reverse().forEach(function (commit) {
      if (commit.author == null) {
        return;
      } else {
        const name = commit.author.login;
        const url = commit.author.html_url;
        const avatar = commit.author.avatar_url;
        contributors.set(name, { name, url, avatar });
      }
    });

    $("#update-time").text(localDate);
    $("#update-time").href = commit.html_url;
    Array.from(contributors, ([_, value]) => value).reverse().forEach(function (contributor) {
      $("#contributors").append(`<li class="contributor-avatar"><a target="_blank" rel="noopener" href="https://github.com/${contributor.name}" title="${contributor.name}"><img src="${contributor.avatar}" alt="${contributor.name}"/></a></li>`);
    });
  });
</script>
        
        
  <div class="article-category">
    <a class="article-category-link" href="../../categories/Power-Automate/">Power Automate</a>►<a class="article-category-link" href="../../categories/Power-Automate/Cloud-flow/">Cloud flow</a>
  </div>

        
        <a href="https://github.com/jpdynamicscrm/blog/issues/new?title=&body=%0A%0A---%0A%0A%23%23%23%23+Document+Details%0A%0A%E2%9A%A0+*Do+not+edit+this+section.%0A%0A*+ID%3A+544ab6fd-aa1e-520f-ba0f-6ff4f96a053a%0A*+%E5%AF%BE%E8%B1%A1%E8%A8%98%E4%BA%8B%3A+%5B%E3%82%AF%E3%83%A9%E3%82%A6%E3%83%89+%E3%83%95%E3%83%AD%E3%83%BC%E3%81%A7+Microsoft+Purview+%E3%81%AE%E7%9B%A3%E6%9F%BB%E3%83%AD%E3%82%B0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95%5D%28https%3A%2F%2Fjpdynamicscrm.github.io%2Fblog%2Fpowerautomate%2Fwork-with-audit-log%2F%29%0A*+Content+Source%3A+%5Barticles%2Fpowerautomate%2Fwork-with-audit-log.md%5D%28https%3A%2F%2Fgithub.com%2Fjpdynamicscrm%2Fblog%2Fblob%2Fmaster%2Farticles%2Fpowerautomate%2Fwork-with-audit-log.md%29%0A*+Author%3A+" class="article-github-issue-link" target="_blank" rel="noopener noreferrer">feedback</a>
        
        <a data-url="https://jpdynamicscrm.github.io/blog/powerautomate/work-with-audit-log/" data-id="cmlu6hu0t00mu0mmt1xbz0v7k" class="article-share-link">共有</a>
      </div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>こんにちは、Power Platform サポートの清水です。<br>今回は、よくお問い合わせをいただく題材の一つとして、クラウド フローを使用して、Microsoft Purview の監査ログを取得する方法について紹介します。  </p>
<p>2023 年 10 月現時点では、監査ログを取得できるようなコネクタ・アクションは存在しないため、監査ログを取得するには、<a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/">Office 365 Management API</a> を使用する必要があります。<br>少し複雑なフローになりますが、最後までお付き合いいただければと思います。  </p>
<h2 id="必要なライセンスについて"><a href="#必要なライセンスについて" class="headerlink" title="必要なライセンスについて"></a>必要なライセンスについて</h2><p>プレミアム コネクタを使用するフローとなりますので、有償ライセンスが必要です。<br>以下のいずれかのライセンス/環境があれば、フローを実行可能です。  </p>
<ul>
<li>Power Automate Premium (※ 旧名: Power Automate per user with attended RPA)  </li>
<li>Power Automate Process</li>
<li>Power Automate per user (※ 2023/8/1~ レガシー)</li>
<li>Power Automate per flow (※ 2023/8/1~ レガシー)</li>
<li>従量課金制環境  </li>
</ul>
<h2 id="必要な権限について"><a href="#必要な権限について" class="headerlink" title="必要な権限について"></a>必要な権限について</h2><p>Office 365 Management API を使用するために必要なアクセス許可を付与する際、テナント管理者の同意が必要となります。<br>同意の付与には、グローバル管理者の権限が必要です。</p>
<h2 id="手順の概要"><a href="#手順の概要" class="headerlink" title="手順の概要"></a>手順の概要</h2><p>フローは大きく 7 つのステップで構成されます。  </p>
<ol start="0">
<li>事前準備<br>Office 365 Management API を使用する準備として、Microsoft Entra ID へのアプリケーションの登録およびアクセス許可の付与などを行います。<br>ここでは Power Automate は使用いたしません。  </li>
<li>事前準備で取得したパラメータを変数に格納  </li>
<li>Office 365 Management API で既存のサブスクリプションの確認<br>監査ログを API から取得するために、まずはサブスクリプションを開始する必要があります。<br>既に開始済みで有効な状態であれば、サブスクリプションを新しく開始する必要はないので、本ステップでは、既存のサブスクリプションがあるかどうかを確認します。  </li>
<li>(既存のサブスクリプションが存在しない場合) Office 365 Management API でサブスクリプションの開始<br>手順 1 で既存のサブスクリプションの一覧を取得したので、目的のサブスクリプションがないか、無効な状態の場合には、サブスクリプションを開始します。  </li>
<li>Office 365 Management API でコンテンツ リストの取得<br>コンテンツ (監査ログ) 自体を取得するために、まずは取得可能なコンテンツ リストを取得する必要があります。<br>このコンテンツ リストで得られた値を使用して、後続のステップでコンテンツ自体を取得していきます。</li>
<li>Office 365 Management API でコンテンツの取得<br>コンテンツを取得し、変数に格納していきます。  </li>
<li>CSVファイルの作成・保存<br>CSV ファイルを作成し、クラウド ストレージに保存したら完了です。  </li>
</ol>
<p>それでは、詳細な手順について見ていきましょう。  </p>
<h2 id="0-事前準備"><a href="#0-事前準備" class="headerlink" title="0. 事前準備"></a>0. 事前準備</h2><p><strong>0-1．アプリの登録</strong><br>Office 365 Management API の利用を開始するため、<a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/get-started-with-office-365-management-apis#register-your-application-in-azure-ad">Office 365 Management API の使用を開始する</a> の下記の箇所を実施してください。  </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/get-started-with-office-365-management-apis#use-the-azure-portal-to-register-your-application-in-azure-ad">Azure Portal を使用してアプリケーションを Microsoft Entra ID に登録する</a><br>※リダイレクト URI は空のまま作成します。  </li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/get-started-with-office-365-management-apis#generate-a-new-key-for-your-application">アプリケーションの新しいキーを生成する</a> </li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/get-started-with-office-365-management-apis#specify-the-permissions-your-app-requires-to-access-the-office-365-management-apis">アプリが Office 365 Management APIにアクセスするために必要な許可を指定します。</a><br>※今回は HTTP コネクタを使用するため、手順 3 では「b. アプリケーションのアクセス許可」を選択してください。</li>
</ul>
<p>手順の完了後、フローで使用する以下 3 つの値を控えておきます。  </p>
<ul>
<li>アプリケーション (クライアント) ID  </li>
<li>ディレクトリ (テナント) ID<br><img src="/blog/powerautomate/work-with-audit-log/enrolled-app-property.png" alt="アプリの概要"></li>
<li>作成したシークレットの値<br><img src="/blog/powerautomate/work-with-audit-log/secret.png" alt="シークレットの値"></li>
</ul>
<p><strong>0-2．Office 365 Management API のエンドポイントの確認</strong><br>Office 365 Management API のエンドポイントを以下から確認します。<br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/office-365-management-activity-api-reference#activity-api-operations">アクティビティ API の操作</a>  </p>
<p>今回使用する検証用のテナントでは、パブリック クラウドを使用しているため、”Enterprise プラン” の URL を使用します。  </p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://manage.office.com/api/v1.0/&#123;tenant_id&#125;/activity/feed/&#123;operation&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>&#123;tenant_id&#125;</code> 部分には、ご使用のテナント ID を指定します。  </li>
<li><code>&#123;operation&#125;</code> 部分には、これから使用する API の “パス” を指定します。  </li>
</ul>
<p><strong>0-3．Office 365 Management API のコンテンツタイプの確認</strong><br>このフローで取得したい監査ログの種類を以下から確認します。<br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/office-365-management-activity-api-reference#working-with-the-office-365-management-activity-api">Office 365 管理アクティビティ API の操作</a>  </p>
<p>本ブログでは、<code>Audit.AzureActiveDirectory</code> を対象とすることとします。  </p>
<h2 id="1-事前準備で取得したパラメータをフローの変数に格納"><a href="#1-事前準備で取得したパラメータをフローの変数に格納" class="headerlink" title="1. 事前準備で取得したパラメータをフローの変数に格納"></a>1. 事前準備で取得したパラメータをフローの変数に格納</h2><p>ここからフローの作成に入っていきます。  </p>
<p><strong>1-1．トリガーを決定し、フローを一から作成</strong><br>今回は日次でログを取得することにしたいので、繰り返しトリガーを選択します。<br>トリガーの設定は要件に合わせてご設定ください。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/trigger.png" alt="trigger">  </p>
<p><strong>1-2．事前準備で取得した 5 つの値を変数に格納</strong><br>変数コネクタ「変数を初期化する」アクションを 5 つフローに追加し、それぞれ以下のように設定します。</p>
<ul>
<li>テナント ID</li>
</ul>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-tenantid.png" alt="変数を初期化-テナント ID">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>tenantID</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td>0-1 で取得した「ディレクトリ (テナント) ID」</td>
</tr>
</tbody></table>
<ul>
<li>クライアント ID  </li>
</ul>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-clientid.png" alt="変数を初期化-クライアント ID">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>clientID</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td>0-1 で取得した「アプリケーション (クライアント) ID」</td>
</tr>
</tbody></table>
<ul>
<li>シークレット</li>
</ul>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-secret.png" alt="変数を初期化-シークレット">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>secret</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td>0-1 で取得した「シークレット」</td>
</tr>
</tbody></table>
<ul>
<li>エンドポイント</li>
</ul>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-endpoint.png" alt="変数を初期化-エンドポイント">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>endpoint</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td>0-2 で取得したエンドポイントの “/{operation}” の直前まで<br>例: <a target="_blank" rel="noopener" href="https://manage.office.com/api/v1.0/@%7Bvariables(&#39;tenantID&#39;)}/activity/feed">https://manage.office.com/api/v1.0/@{variables(&#39;tenantID&#39;)}/activity/feed</a></td>
</tr>
</tbody></table>
<ul>
<li>コンテンツタイプ</li>
</ul>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-contenttype.png" alt="変数を初期化-コンテンツタイプ">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contentType</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td>0-3 で取得した「コンテンツ タイプ」<br>例: <code>Audit.AzureActiveDirectory</code></td>
</tr>
</tbody></table>
<h2 id="2．Office-365-Management-API-で既存のサブスクリプションの確認"><a href="#2．Office-365-Management-API-で既存のサブスクリプションの確認" class="headerlink" title="2．Office 365 Management API で既存のサブスクリプションの確認"></a>2．Office 365 Management API で既存のサブスクリプションの確認</h2><p>監査ログを API から取得するために、まずはサブスクリプションを開始する必要があります。<br>既に開始済みで有効な状態であれば、サブスクリプションを新しく開始する必要はないので、本ステップでは、既存のサブスクリプションがあるかどうかを確認します。  </p>
<p>ここでは、以下の API を使用します。<br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/office-365-management-activity-api-reference#list-current-subscriptions">現在のサブスクリプションのリストの作成</a>  </p>
<p><strong>2-1．サブスクリプション リストの作成</strong><br>HTTP コネクタ「HTTP」アクションをフローに追加し、API のリファレンスに従って、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/http-list-subscriptions.png" alt="HTTPアクション-サブスクリプションリストを確認">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>方法</td>
<td>GET</td>
</tr>
<tr>
<td>URI</td>
<td><code>@&#123;variables(&#39;endpoint&#39;)&#125;</code>/subscriptions/list</td>
</tr>
<tr>
<td>認証</td>
<td>Active Directory OAuth</td>
</tr>
<tr>
<td>テナント</td>
<td>動的なコンテンツ &gt; <code>tenantID</code></td>
</tr>
<tr>
<td>対象ユーザー</td>
<td><code>https://manage.office.com/</code></td>
</tr>
<tr>
<td>クライアント ID</td>
<td>動的なコンテンツ &gt; <code>clientID</code></td>
</tr>
<tr>
<td>資格情報の種類</td>
<td>シークレット</td>
</tr>
<tr>
<td>シークレット</td>
<td>動的なコンテンツ &gt; <code>secret</code></td>
</tr>
</tbody></table>
<p>まずはここまででフローを実行してみましょう。<br>フローの実行が成功し、下図赤枠のような出力が得られました。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/http-list-subscriptions-result.png" alt="HTTPアクション-サブスクリプションリストの確認結果">  </p>
<p>詳しく見てみると、以下のような JSON が出力されています。  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;contentType&quot;</span>: <span class="string">&quot;Audit.General&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;enabled&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webhook&quot;</span>: <span class="literal">null</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;contentType&quot;</span>: <span class="string">&quot;Audit.SharePoint&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;enabled&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webhook&quot;</span>: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><code>Audit.General</code> と <code>Audit.SharePoint</code> のサブスクリプションがリストされていて、どちらも status が <code>enabled</code> になっていますね。<br><code>Audit.General</code> と <code>Audit.SharePoint</code> のコンテンツタイプのサブスクリプションは有効のようですが、今回取得したい <code>Audit.AzureActiveDirectory</code> については開始されていないようなので、次のステップで追加していきます。  </p>
<h2 id="3-既存のサブスクリプションが存在しない場合-Office-365-Management-API-でサブスクリプションの開始"><a href="#3-既存のサブスクリプションが存在しない場合-Office-365-Management-API-でサブスクリプションの開始" class="headerlink" title="3. (既存のサブスクリプションが存在しない場合) Office 365 Management API でサブスクリプションの開始"></a>3. (既存のサブスクリプションが存在しない場合) Office 365 Management API でサブスクリプションの開始</h2><p>まずは、既存のサブスクリプションが存在するかどうかを「条件」アクションでチェックします。  </p>
<p>条件の結果が「はい」の場合、既存の有効なサブスクリプションが存在しないので、Office 365 Management API を使用して、新たにサブスクリプションを開始します。<br>ここでは、以下の API を使用します。<br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/office-365-management-activity-api-reference#start-a-subscription">サブスクリプションの開始</a>  </p>
<p><strong>3-1. 既存の有効なサブスクリプションを抽出</strong><br>データ操作コネクタ「アレイのフィルター処理」アクションを追加し、以下のように設定します。<br>以下のアクションでは、<code>HTTP | サブスクリプションリストを確認</code> アクションの出力から、status が <code>enabled</code> かつ contentType が <code>contentType 変数の値</code> に等しいオブジェクトのみを抽出します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/filter-array.png" alt="アレイのフィルター処理">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>差出人</td>
<td>動的なコンテンツ &gt; <code>HTTP | サブスクリプションリストを確認</code> - <code>本文</code></td>
</tr>
<tr>
<td>条件</td>
<td>[詳細設定モードで編集] をクリック &gt; 下式を入力 <br> <code>@and(equals(item()?[&#39;status&#39;], &#39;enabled&#39;), equals(item()?[&#39;contentType&#39;], variables(&#39;contentType&#39;)))</code></td>
</tr>
</tbody></table>
<p><strong>3-2．既存の有効なサブスクリプションが存在するかどうかを判定</strong><br>コントロールコネクタ「条件」アクションを追加し、以下のように設定します。<br>以下のアクションでは、<code>アレイのフィルター処理</code> アクションの出力が空かどうかを判定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/condition.png" alt="条件">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>左辺</td>
<td>式 &gt; <code>empty(body(&#39;アレイのフィルター処理&#39;))</code></td>
</tr>
<tr>
<td>条件</td>
<td>次の値に等しい</td>
</tr>
<tr>
<td>右辺</td>
<td>式 &gt; <code>true</code></td>
</tr>
</tbody></table>
<p><strong>3-3．サブスクリプションの開始</strong><br><code>はいの場合</code> 内にHTTP コネクタ「HTTP」アクションをフローに追加し、API のリファレンスに従って、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/http-start-subscription.png" alt="HTTPアクション-サブスクリプションを開始">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>方法</td>
<td>POST</td>
</tr>
<tr>
<td>URI</td>
<td><code>@&#123;variables(&#39;endpoint&#39;)&#125;</code>/subscriptions/start?contentType=<code>@&#123;variables(&#39;contentType&#39;)&#125;</code></td>
</tr>
<tr>
<td>ヘッダー</td>
<td><code>Content-Type</code>: <code>application/json; utf-8</code></td>
</tr>
<tr>
<td>認証</td>
<td>Active Directory OAuth</td>
</tr>
<tr>
<td>テナント</td>
<td>動的なコンテンツ &gt; <code>tenantID</code></td>
</tr>
<tr>
<td>対象ユーザー</td>
<td><code>https://manage.office.com/</code></td>
</tr>
<tr>
<td>クライアント ID</td>
<td>動的なコンテンツ &gt; <code>clientID</code></td>
</tr>
<tr>
<td>資格情報の種類</td>
<td>シークレット</td>
</tr>
<tr>
<td>シークレット</td>
<td>動的なコンテンツ &gt; <code>secret</code></td>
</tr>
</tbody></table>
<h2 id="4-Office-365-Management-API-でコンテンツリストの取得"><a href="#4-Office-365-Management-API-でコンテンツリストの取得" class="headerlink" title="4. Office 365 Management API でコンテンツリストの取得"></a>4. Office 365 Management API でコンテンツリストの取得</h2><p>無事サブスクリプションが開始できたので、続いて、目的のコンテンツ タイプで現在取得できるコンテンツ一覧を取得します。<br>ここでは、以下の API を使用します。<br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/office-365-management-activity-api-reference#list-available-content">利用可能なコンテンツのリストの作成</a>  </p>
<p>API のリファレンスを読むと、取得したいコンテンツの時間範囲をパラメータとして指定できるようですが、時間範囲は 24 時間以内とするよう推奨されています。<br>そのため、本フローでは、フロー実行日の前日 24 時間分のコンテンツを取得するよう設定します。  </p>
<p>また、本 API では、改ページが発生する可能性があるようです。<br>大量の監査ログが存在する場合に、改ページの処理を行わないと、全てのデータが取得できない恐れがあるため、Do until アクションを使用して、改ページへの対応も行っていきます。</p>
<p><strong>4-1．startTime を前日の 00:00 JST (UTC: 15:00) に指定</strong><br>変数コネクタ「変数を初期化する」アクションを追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-startTime.png" alt="変数を初期化-startTime">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>startTime</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td><code>@&#123;addDays(convertFromUtc(utcNow(), &#39;Tokyo Standard Time&#39;), -2, &#39;yyyy-MM-dd&#39;)&#125;</code>T15:00:00Z</td>
</tr>
</tbody></table>
<p><strong>4-2．endTime を前日の 23：59 JST (UTC: 14:59) に指定</strong><br>変数コネクタ - 変数を初期化するアクションを追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-endTime.png" alt="変数を初期化-endTime">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>endTime</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td><code>@&#123;addDays(convertFromUtc(utcNow(), &#39;Tokyo Standard Time&#39;), -1, &#39;yyyy-MM-dd&#39;)&#125;</code>T14:59:59Z</td>
</tr>
</tbody></table>
<p><strong>4-3．配列変数を 2 つ用意</strong><br>監査ログの取得結果を格納するための変数を事前に用意します。<br>変数コネクタ「変数を初期化する」アクションを 2 つフローに追加し、それぞれ以下のように設定します。   </p>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-contents.png" alt="変数を初期化-contents">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contents</td>
</tr>
<tr>
<td>種類</td>
<td>アレイ</td>
</tr>
<tr>
<td>値</td>
<td>空欄のまま</td>
</tr>
</tbody></table>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-contentsAll.png" alt="変数を初期化-contentsAll">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contentsAll</td>
</tr>
<tr>
<td>種類</td>
<td>アレイ</td>
</tr>
<tr>
<td>値</td>
<td>空欄のまま</td>
</tr>
</tbody></table>
<p><strong>4-4．改ページに対応するための変数と繰り返しアクションを用意</strong><br>変数コネクタ「変数を初期化する」アクションを追加し、以下のように設定します。<br>ここでは、コンテンツリストを取得するための URI を変数に格納します。リファレンスに従って設定してください。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/init-variable-contentslisturi.png" alt="変数を初期化-contentsListUri">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contentsListUri</td>
</tr>
<tr>
<td>種類</td>
<td>文字列</td>
</tr>
<tr>
<td>値</td>
<td><code>@&#123;variables(&#39;endpoint&#39;)&#125;/subscriptions/content?contentType=@&#123;variables(&#39;contentType&#39;)&#125;&amp;startTime=@&#123;variables(&#39;startTime&#39;)&#125;&amp;endTime=@&#123;variables(&#39;endTime&#39;)&#125;</code></td>
</tr>
</tbody></table>
<p>コントロールコネクタ「Do until」アクションを追加し、以下のように設定します。</p>
<p><img src="/blog/powerautomate/work-with-audit-log/dountil.png" alt="Do until">    </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>左辺</td>
<td>動的なコンテンツ &gt; <code>contentListUri</code></td>
</tr>
<tr>
<td>条件</td>
<td>次のもので始まらない</td>
</tr>
<tr>
<td>右辺</td>
<td><a target="_blank" rel="noopener" href="https://manage.office.com/">https://manage.office.com/</a></td>
</tr>
</tbody></table>
<p><strong>4-5．コンテンツリストの取得</strong><br>Do until 内で HTTP コネクタ「HTTP」アクションをフローに追加し、API のリファレンスに従って、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/http-content.png" alt="HTTPアクション-コンテンツリストの取得">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>方法</td>
<td>GET</td>
</tr>
<tr>
<td>URI</td>
<td>動的なコンテンツ &gt; <code>contentListUri</code></td>
</tr>
<tr>
<td>認証</td>
<td>Active Directory OAuth</td>
</tr>
<tr>
<td>テナント</td>
<td>動的なコンテンツ &gt; <code>tenantID</code></td>
</tr>
<tr>
<td>対象ユーザー</td>
<td><code>https://manage.office.com/</code></td>
</tr>
<tr>
<td>クライアント ID</td>
<td>動的なコンテンツ &gt; <code>clientID</code></td>
</tr>
<tr>
<td>資格情報の種類</td>
<td>シークレット</td>
</tr>
<tr>
<td>シークレット</td>
<td>動的なコンテンツ &gt; <code>secret</code></td>
</tr>
</tbody></table>
<p>さて、ここまでで一度フローを実行してみましょう。  </p>
<p>フローが正常に実行され、<code>HTTP | コンテンツリストの作成</code> アクションまで正常に完了しました。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/http-content-result.png" alt="コンテンツリストの作成結果">  </p>
<p>さらに「HTTP | コンテンツリストの作成」アクションの本文を詳しく見てみると、以下のようなデータが取得されています。  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;contentUri&quot;</span>: <span class="string">&quot;https://manage.office.com/api/v1.0/&#123;tenantID&#125;/activity/feed/audit/20231016001037495037203$20231016005646231021586$audit_azureactivedirectory$Audit_AzureActiveDirectory$jpn0016&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentId&quot;</span>: <span class="string">&quot;20231016001037495037203$20231016005646231021586$audit_azureactivedirectory$Audit_AzureActiveDirectory$jpn0016&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentType&quot;</span>: <span class="string">&quot;Audit.AzureActiveDirectory&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentCreated&quot;</span>: <span class="string">&quot;2023-10-16T00:56:46.231Z&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentExpiration&quot;</span>: <span class="string">&quot;2023-10-23T00:10:37.495Z&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;contentUri&quot;</span>: <span class="string">&quot;https://manage.office.com/api/v1.0/&#123;tenantID&#125;/activity/feed/audit/20231016010437450010083$20231016044336610021746$audit_azureactivedirectory$Audit_AzureActiveDirectory$jpn0016&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentId&quot;</span>: <span class="string">&quot;20231016010437450010083$20231016044336610021746$audit_azureactivedirectory$Audit_AzureActiveDirectory$jpn0016&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentType&quot;</span>: <span class="string">&quot;Audit.AzureActiveDirectory&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentCreated&quot;</span>: <span class="string">&quot;2023-10-16T04:43:36.610Z&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;contentExpiration&quot;</span>: <span class="string">&quot;2023-10-23T00:10:37.495Z&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    …</span><br></pre></td></tr></table></figure>

<p>このデータをどう活用していくのかを確認するために、Office 365 Management API のリファレンスを見てみると、上記のコンテンツ リストに含まれる <code>contentUri</code> に対して GET 要求を行うことで、コンテンツ (=アクションまたはイベントのコレクション) が取得できるようです。  </p>
<p>そこで、次のアクションでは、コンテンツリスト内の各 contentUri に対して GET 要求を行っていきます。  </p>
<h2 id="5-Office-365-Management-API-でコンテンツの取得"><a href="#5-Office-365-Management-API-でコンテンツの取得" class="headerlink" title="5. Office 365 Management API でコンテンツの取得"></a>5. Office 365 Management API でコンテンツの取得</h2><p>コンテンツの取得には、以下の API を使用します。<br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/office/office-365-management-api/office-365-management-activity-api-reference#retrieving-content">コンテンツの取得</a>  </p>
<p>リファレンスの “応答のサンプル” を見てみると、一つの contentUri に対して GET 要求を行うと、配列形式で複数のコンテンツが返却されるようです。<br>今回は、複数の contentUri に対して繰り返し GET 要求を行い、得られた配列を 1 つの CSV に出力したいので、事前に CSV 作成のための変数を用意しておき、各 contentUri から得られた配列は変数に格納していくこととします。<br>Power Automate の「変数の設定」アクションでは、自己参照ができないため、配列を結合しながら CSV にまとめていくために、手順 4-3 で 2 つの変数を用意しています。  </p>
<p><strong>5-1．GET 要求を繰り返すためのループアクションを作成</strong><br>Do until 内でコントロールコネクタ「Apply to each」アクションをフローに追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/apply-to-each.png" alt="Apply to each">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>以前の手順から出力を選択</td>
<td>動的なコンテンツ &gt; <code>HTTP | コンテンツリストの作成</code> &gt; <code>本文</code></td>
</tr>
</tbody></table>
<p><strong>5-2．コンテンツの取得</strong><br>Apply to each 内で HTTP コネクタ「HTTP」アクションを追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/http-contents.png" alt="HTTP-コンテンツの取得">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>方法</td>
<td>GET</td>
</tr>
<tr>
<td>URI</td>
<td>式 &gt; <code>items(&#39;Apply_to_each&#39;)?[&#39;contentUri&#39;]</code></td>
</tr>
<tr>
<td>認証</td>
<td>Active Directory OAuth</td>
</tr>
<tr>
<td>テナント</td>
<td>動的なコンテンツ &gt; <code>tenantID</code></td>
</tr>
<tr>
<td>対象ユーザー</td>
<td><code>https://manage.office.com/</code></td>
</tr>
<tr>
<td>クライアント ID</td>
<td>動的なコンテンツ &gt; <code>clientID</code></td>
</tr>
<tr>
<td>資格情報の種類</td>
<td>シークレット</td>
</tr>
<tr>
<td>シークレット</td>
<td>動的なコンテンツ &gt; <code>secret</code></td>
</tr>
</tbody></table>
<p><strong>5-3．contentsAll 変数の値を一時的に contents 変数に退避</strong><br>Apply to each 内で変数コネクタ「変数の設定」アクションを追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/set-variable-contents.png" alt="変数の設定-contents"></p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contents</td>
</tr>
<tr>
<td>値</td>
<td>動的なコンテンツ &gt; <code>変数</code> &gt; <code>contentsAll</code></td>
</tr>
</tbody></table>
<p><strong>5-4．contents 変数の値と「HTTP | コンテンツの取得」アクションの本文を結合して contentsAll に格納</strong><br>Apply to each 内で変数コネクタ「変数の設定」アクションを追加し、以下のように設定します。<br>配列の結合には、<a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/azure/logic-apps/workflow-definition-language-functions-reference#union"><code>union</code> 関数</a> を使用します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/set-variable-contentsall.png" alt="変数の設定-contentsall">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contentsAll</td>
</tr>
<tr>
<td>値</td>
<td>式 &gt; <code>union(json(body(&#39;HTTP_|_コンテンツの取得&#39;)), variables(&#39;contents&#39;))</code></td>
</tr>
</tbody></table>
<p><strong>5-5．「HTTP | コンテンツリストの作成」のヘッダーに NextPageUri があるかを確認</strong><br>Do until 内でコントロールコネクタ「条件」アクションを追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/condition2.png" alt="条件">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>左辺</td>
<td>式 &gt; <code>outputs(&#39;HTTP_|_コンテンツリストの作成&#39;)[&#39;headers&#39;]?[&#39;NextPageUri&#39;]</code></td>
</tr>
<tr>
<td>条件</td>
<td>次の値に等しくない</td>
</tr>
<tr>
<td>右辺</td>
<td>式 &gt; <code>Null</code></td>
</tr>
</tbody></table>
<p><strong>5-6．NextPageUri が存在する場合、contentsListUri 変数を NextPageUri で更新</strong><br><code>はいの場合</code> 内に変数コネクタ「変数の設定」アクションをフローに追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/set-variable-nextpageuri.png" alt="変数の設定-NextPageUri">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contentsListUri</td>
</tr>
<tr>
<td>値</td>
<td>式 &gt; <code>outputs(&#39;HTTP_|_コンテンツリストの作成&#39;)[&#39;headers&#39;]?[&#39;NextPageUri&#39;]</code></td>
</tr>
</tbody></table>
<p><strong>5-7．NextPageUri が存在しない場合、contentsListUri 変数を 0 で更新</strong><br><code>いいえの場合</code> 内に変数コネクタ「変数の設定」アクションをフローに追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/set-variable-no-nextpageuri.png" alt="変数の設定-NextPageUri">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>名前</td>
<td>contentsListUri</td>
</tr>
<tr>
<td>値</td>
<td>0</td>
</tr>
</tbody></table>
<h2 id="6-CSVファイルの作成・保存"><a href="#6-CSVファイルの作成・保存" class="headerlink" title="6. CSVファイルの作成・保存"></a>6. CSVファイルの作成・保存</h2><p>これで監査ログの値を全て取得できたので、最後に CSV を作成してクラウド ストレージに保存します。  </p>
<p><strong>6-1．CSV ファイルの作成</strong><br>データ操作コネクタ「CSV テーブルの作成」アクションを追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/create-csv-table.png" alt="CSVテーブルの作成">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>開始</td>
<td>動的なコンテンツ &gt; <code>変数</code> &gt; <code>contentsAll</code></td>
</tr>
</tbody></table>
<p><strong>6-2．CSV ファイルの保存</strong><br>今回は SharePoint のドキュメントライブラリに保存しますが、こちらはアクションの一例ですので、任意のストレージに保存してください。<br>SharePoint コネクタ「ファイルの作成」アクションを追加し、以下のように設定します。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/create-file.png" alt="CSVファイルの保存">  </p>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>値</th>
</tr>
</thead>
<tbody><tr>
<td>サイトのアドレス</td>
<td>任意のサイト</td>
</tr>
<tr>
<td>フォルダ―のパス</td>
<td>任意のパス</td>
</tr>
<tr>
<td>ファイル名</td>
<td>任意のファイル名(拡張子: .csv)</td>
</tr>
<tr>
<td>ファイル コンテンツ</td>
<td>動的なコンテンツ &gt; <code>CSV テーブルの作成</code> &gt; <code>出力</code></td>
</tr>
</tbody></table>
<h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><p>長大なフローになりましたので、最後にフローの全体像を貼っておきます。<br>全体の構成に誤りがないか、以下のキャプチャと見比べて確認してみてください。  </p>
<p>今回は <code>Audit.AzureActiveDirectory</code> のコンテンツ タイプを対象に API を実行しましたが、SharePoint など他のコンテンツ タイプについても同じ構成のフローで実行できますので、ぜひカスタマイズして便利なフローを作ってみてください。  </p>
<p><img src="/blog/powerautomate/work-with-audit-log/flow.png" alt="フロー全体像"></p>
<h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>Power Automate のテンプレートギャラリーには、”<a target="_blank" rel="noopener" href="https://make.powerautomate.com/galleries/public/templates/4a7ea95259f1404e95855f6b053360b1/office-365-%E3%81%AE%E7%9B%A3%E6%9F%BB%E3%83%AD%E3%82%B0%E3%81%A7%E7%89%B9%E5%AE%9A%E3%81%AE%E8%A9%B3%E7%B4%B0%E3%82%92%E7%9B%A3%E8%A6%96%E3%81%97%E3%81%A6%E3%82%A2%E3%83%A9%E3%83%BC%E3%83%88%E3%82%92%E9%80%81%E4%BF%A1">Office 365 の監査ログで特定の詳細を監視してアラートを送信</a>“ というテンプレートがありますが、こちらは古い API を使用しているため、現時点では使用が推奨されておりません。<br>監査ログの取得については、Office 365 Management API でのフローの作成をご検討ください。</p>

      
      
        <div class="article-disclaimer">
        
          <p>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p>
        
        </div>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Cloud-flow/" rel="tag">Cloud flow</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Office-365-Management-API/" rel="tag">Office 365 Management API</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Power-Automate/" rel="tag">Power Automate</a></li></ul>

        
        <a href="https://github.com/jpdynamicscrm/blog/edit/master/articles/powerautomate/work-with-audit-log.md" class="article-github-edit-link" target="_blank" rel="noopener noreferrer">GitHub で編集</a>
        
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../powerplatform/vnetgateway-support-status/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">次の記事</strong>
      <div class="article-nav-title">
        
          Power Platform での仮想ネットワーク データ ゲートウェイについて
        
      </div>
    </a>
  
  
    <a href="../../powerplatform/ChangePersonalizationSettings/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前の記事</strong>
      <div class="article-nav-title">ユーザーの個人設定を管理者が変更する方法</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最近の投稿</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../../powerplatform/dataverse-bulk-delete-guide/">Dataverse 容量不足を解消！一括削除機能の使い方と注意点まとめ</a>
          </li>
        
          <li>
            <a href="../../powerpages/power-pages-auth-key/">Power Pages 認証キーの更新ガイド</a>
          </li>
        
          <li>
            <a href="../../powerplatform/power-platform-powershell-admin-guide/">Power Platform 管理者向け PowerShell でできること代表例まとめ</a>
          </li>
        
          <li>
            <a href="../../powerplatform/dataverse-search-storage-guide/">Dataverse Search のストレージ内訳と削減の考え方（Q&amp;Aガイド）</a>
          </li>
        
          <li>
            <a href="../../canvasapp/sharepoint-image-mobile-issue/">モバイル端末で SharePoint をソースにしたキャンバスアプリの画像やメディアが表示されない場合の対処方法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">タグ</h3>
    <div class="widget">
      <!-- <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="../../tags/AI-builder/" rel="tag">AI builder</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Administration/" rel="tag">Administration</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/App-Access-Checker/" rel="tag">App Access Checker</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Audit-Log/" rel="tag">Audit Log</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Canvas-App/" rel="tag">Canvas App</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Canvas-app/" rel="tag">Canvas app</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Capacity/" rel="tag">Capacity</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Cloud-flow/" rel="tag">Cloud flow</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Connector-and-Connection/" rel="tag">Connector and Connection</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Copilot/" rel="tag">Copilot</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Copilot-Studio/" rel="tag">Copilot Studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/DLP-%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC/" rel="tag">DLP ポリシー</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dataflow/" rel="tag">Dataflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dataverse/" rel="tag">Dataverse</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dataverse-for-Teams/" rel="tag">Dataverse for Teams</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dataverse-%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8/" rel="tag">Dataverse ストレージ</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Desktop-flow/" rel="tag">Desktop flow</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Developer-Environment/" rel="tag">Developer Environment</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dynamics/" rel="tag">Dynamics</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dynamics-365/" rel="tag">Dynamics 365</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Environment/" rel="tag">Environment</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Exchange/" rel="tag">Exchange</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Governance/" rel="tag">Governance</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Graph-API/" rel="tag">Graph API</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/How-to/" rel="tag">How to</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Ideas/" rel="tag">Ideas</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Information/" rel="tag">Information</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/License/" rel="tag">License</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Microsoft-Copilot-Studio/" rel="tag">Microsoft Copilot Studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Microsoft-Teams-%E9%80%A3%E6%90%BA/" rel="tag">Microsoft Teams 連携</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Mobile/" rel="tag">Mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Model-driven-app/" rel="tag">Model-driven app</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Network/" rel="tag">Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Office-365-Management-API/" rel="tag">Office 365 Management API</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Apps/" rel="tag">Power Apps</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Automate/" rel="tag">Power Automate</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Automate-for-desktop/" rel="tag">Power Automate for desktop</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Pages/" rel="tag">Power Pages</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Platform/" rel="tag">Power Platform</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Platform-%E7%AE%A1%E7%90%86%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC/" rel="tag">Power Platform 管理センター</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/PowerPlatform/" rel="tag">PowerPlatform</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/PowerShell/" rel="tag">PowerShell</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/SR/" rel="tag">SR</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Security/" rel="tag">Security</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Settings/" rel="tag">Settings</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/SharePoint/" rel="tag">SharePoint</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/SharePoint-Online/" rel="tag">SharePoint Online</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/VNetGateway/" rel="tag">VNetGateway</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/dataverse/" rel="tag">dataverse</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/governance/" rel="tag">governance</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/licensing/" rel="tag">licensing</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/powerapps/" rel="tag">powerapps</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/powerpages/" rel="tag">powerpages</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E5%85%A8%E8%88%AC/" rel="tag">お問い合わせ全般</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4/" rel="tag">オンプレミス データ ゲートウェイ</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%A2%E3%83%97%E3%83%AA/" rel="tag">キャンバスアプリ</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88/" rel="tag">サポート</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88-%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88/" rel="tag">サポート リクエスト</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8/" rel="tag">ストレージ</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3-%E3%83%AD%E3%83%BC%E3%83%AB/" rel="tag">セキュリティ ロール</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%AD%E3%83%BC%E3%83%AB/" rel="tag">セキュリティロール</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E7%A7%BB%E8%A1%8C/" rel="tag">テナント移行</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0/" rel="tag">トラブルシューティング</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%83%A2%E3%83%8B%E3%82%BF%E3%83%BC/" rel="tag">モニター</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86/" rel="tag">ユーザー管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E5%A7%94%E4%BB%BB/" rel="tag">委任</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E5%BD%B9%E5%89%B2/" rel="tag">役割</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E6%83%85%E5%A0%B1%E6%8E%A1%E5%8F%96/" rel="tag">情報採取</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E6%A4%9C%E7%B4%A2/" rel="tag">検索</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E7%92%B0%E5%A2%83%E7%AE%A1%E7%90%86/" rel="tag">環境管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E9%87%8D%E8%A6%81%E3%81%AA%E5%A4%89%E6%9B%B4%E7%82%B9-%E5%BB%83%E6%AD%A2/" rel="tag">重要な変更点 (廃止)</a></li></ul>  -->
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Apps/">Power Apps</a><span class="tag-list-count">19</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E5%85%A8%E8%88%AC/">お問い合わせ全般</a><span class="tag-list-count">13</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/PowerShell/">PowerShell</a><span class="tag-list-count">4</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Platform/">Power Platform</a><span class="tag-list-count">26</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Governance/">Governance</a><span class="tag-list-count">15</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/How-to/">How to</a><span class="tag-list-count">21</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Information/">Information</a><span class="tag-list-count">7</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Microsoft-Copilot-Studio/">Microsoft Copilot Studio</a><span class="tag-list-count">4</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/License/">License</a><span class="tag-list-count">5</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Automate/">Power Automate</a><span class="tag-list-count">40</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Connector-and-Connection/">Connector and Connection</a><span class="tag-list-count">5</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Network/">Network</a><span class="tag-list-count">4</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Automate-for-desktop/">Power Automate for desktop</a><span class="tag-list-count">8</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dataverse/">Dataverse</a><span class="tag-list-count">12</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Power-Pages/">Power Pages</a><span class="tag-list-count">1</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Model-driven-app/">Model-driven app</a><span class="tag-list-count">7</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dynamics/">Dynamics</a><span class="tag-list-count">11</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E9%87%8D%E8%A6%81%E3%81%AA%E5%A4%89%E6%9B%B4%E7%82%B9-%E5%BB%83%E6%AD%A2/">重要な変更点 (廃止)</a><span class="tag-list-count">1</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Dynamics-365/">Dynamics 365</a><span class="tag-list-count">3</span><ul></ul></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Microsoft-Teams-%E9%80%A3%E6%90%BA/">Microsoft Teams 連携</a><span class="tag-list-count">2</span><ul></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">アーカイブ</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2026/02/">2026 / 02</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2026/01/">2026 / 01</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/12/">2025 / 12</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/10/">2025 / 10</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/09/">2025 / 09</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/08/">2025 / 08</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/05/">2025 / 05</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/04/">2025 / 04</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/03/">2025 / 03</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/02/">2025 / 02</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/01/">2025 / 01</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/12/">2024 / 12</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/11/">2024 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/10/">2024 / 10</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/07/">2024 / 07</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/06/">2024 / 06</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/01/">2024 / 01</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/11/">2023 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/08/">2023 / 08</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/06/">2023 / 06</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/05/">2023 / 05</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/04/">2023 / 04</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/03/">2023 / 03</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/02/">2023 / 02</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/01/">2023 / 01</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/12/">2022 / 12</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/11/">2022 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/10/">2022 / 10</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/09/">2022 / 09</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/08/">2022 / 08</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/06/">2022 / 06</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/05/">2022 / 05</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/03/">2022 / 03</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/02/">2022 / 02</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/01/">2022 / 01</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2021/11/">2021 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2021/09/">2021 / 09</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2021/08/">2021 / 08</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2021/07/">2021 / 07</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2021/06/">2021 / 06</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2021/04/">2021 / 04</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">タグクラウド</h3>
    <div class="widget tagcloud">
      <a href="../../tags/AI-builder/" style="font-size: 10px;">AI builder</a> <a href="../../tags/Administration/" style="font-size: 10px;">Administration</a> <a href="../../tags/App-Access-Checker/" style="font-size: 10px;">App Access Checker</a> <a href="../../tags/Audit-Log/" style="font-size: 10px;">Audit Log</a> <a href="../../tags/Canvas-App/" style="font-size: 10px;">Canvas App</a> <a href="../../tags/Canvas-app/" style="font-size: 13.33px;">Canvas app</a> <a href="../../tags/Capacity/" style="font-size: 10px;">Capacity</a> <a href="../../tags/Cloud-flow/" style="font-size: 18.67px;">Cloud flow</a> <a href="../../tags/Connector-and-Connection/" style="font-size: 12.67px;">Connector and Connection</a> <a href="../../tags/Copilot/" style="font-size: 10.67px;">Copilot</a> <a href="../../tags/Copilot-Studio/" style="font-size: 10px;">Copilot Studio</a> <a href="../../tags/DLP-%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC/" style="font-size: 10px;">DLP ポリシー</a> <a href="../../tags/Dataflow/" style="font-size: 10px;">Dataflow</a> <a href="../../tags/Dataverse/" style="font-size: 16px;">Dataverse</a> <a href="../../tags/Dataverse-for-Teams/" style="font-size: 10.67px;">Dataverse for Teams</a> <a href="../../tags/Dataverse-%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8/" style="font-size: 10.67px;">Dataverse ストレージ</a> <a href="../../tags/Desktop-flow/" style="font-size: 12px;">Desktop flow</a> <a href="../../tags/Developer-Environment/" style="font-size: 10px;">Developer Environment</a> <a href="../../tags/Dynamics/" style="font-size: 15.33px;">Dynamics</a> <a href="../../tags/Dynamics-365/" style="font-size: 11.33px;">Dynamics 365</a> <a href="../../tags/Environment/" style="font-size: 12.67px;">Environment</a> <a href="../../tags/Exchange/" style="font-size: 10px;">Exchange</a> <a href="../../tags/Governance/" style="font-size: 17.33px;">Governance</a> <a href="../../tags/Graph-API/" style="font-size: 10.67px;">Graph API</a> <a href="../../tags/How-to/" style="font-size: 18.67px;">How to</a> <a href="../../tags/Ideas/" style="font-size: 10px;">Ideas</a> <a href="../../tags/Information/" style="font-size: 14px;">Information</a> <a href="../../tags/License/" style="font-size: 12.67px;">License</a> <a href="../../tags/Microsoft-Copilot-Studio/" style="font-size: 12px;">Microsoft Copilot Studio</a> <a href="../../tags/Microsoft-Teams-%E9%80%A3%E6%90%BA/" style="font-size: 10.67px;">Microsoft Teams 連携</a> <a href="../../tags/Mobile/" style="font-size: 10px;">Mobile</a> <a href="../../tags/Model-driven-app/" style="font-size: 14px;">Model-driven app</a> <a href="../../tags/Network/" style="font-size: 12px;">Network</a> <a href="../../tags/Office-365-Management-API/" style="font-size: 10px;">Office 365 Management API</a> <a href="../../tags/Power-Apps/" style="font-size: 18px;">Power Apps</a> <a href="../../tags/Power-Automate/" style="font-size: 20px;">Power Automate</a> <a href="../../tags/Power-Automate-for-desktop/" style="font-size: 14.67px;">Power Automate for desktop</a> <a href="../../tags/Power-Pages/" style="font-size: 10px;">Power Pages</a> <a href="../../tags/Power-Platform/" style="font-size: 19.33px;">Power Platform</a> <a href="../../tags/Power-Platform-%E7%AE%A1%E7%90%86%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC/" style="font-size: 10px;">Power Platform 管理センター</a> <a href="../../tags/PowerPlatform/" style="font-size: 12px;">PowerPlatform</a> <a href="../../tags/PowerShell/" style="font-size: 12px;">PowerShell</a> <a href="../../tags/SR/" style="font-size: 10px;">SR</a> <a href="../../tags/Security/" style="font-size: 10px;">Security</a> <a href="../../tags/Settings/" style="font-size: 10px;">Settings</a> <a href="../../tags/SharePoint/" style="font-size: 10px;">SharePoint</a> <a href="../../tags/SharePoint-Online/" style="font-size: 10px;">SharePoint Online</a> <a href="../../tags/VNetGateway/" style="font-size: 10px;">VNetGateway</a> <a href="../../tags/dataverse/" style="font-size: 10px;">dataverse</a> <a href="../../tags/governance/" style="font-size: 10.67px;">governance</a> <a href="../../tags/licensing/" style="font-size: 10px;">licensing</a> <a href="../../tags/powerapps/" style="font-size: 10px;">powerapps</a> <a href="../../tags/powerpages/" style="font-size: 10px;">powerpages</a> <a href="../../tags/%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E5%85%A8%E8%88%AC/" style="font-size: 16.67px;">お問い合わせ全般</a> <a href="../../tags/%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4/" style="font-size: 10px;">オンプレミス データ ゲートウェイ</a> <a href="../../tags/%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%90%E3%82%B9%E3%82%A2%E3%83%97%E3%83%AA/" style="font-size: 10px;">キャンバスアプリ</a> <a href="../../tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88/" style="font-size: 10px;">サポート</a> <a href="../../tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88-%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88/" style="font-size: 10px;">サポート リクエスト</a> <a href="../../tags/%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8/" style="font-size: 10px;">ストレージ</a> <a href="../../tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3-%E3%83%AD%E3%83%BC%E3%83%AB/" style="font-size: 10px;">セキュリティ ロール</a> <a href="../../tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%AD%E3%83%BC%E3%83%AB/" style="font-size: 10px;">セキュリティロール</a> <a href="../../tags/%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E7%A7%BB%E8%A1%8C/" style="font-size: 10px;">テナント移行</a> <a href="../../tags/%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0/" style="font-size: 10px;">トラブルシューティング</a> <a href="../../tags/%E3%83%A2%E3%83%8B%E3%82%BF%E3%83%BC/" style="font-size: 10px;">モニター</a> <a href="../../tags/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86/" style="font-size: 10px;">ユーザー管理</a> <a href="../../tags/%E5%A7%94%E4%BB%BB/" style="font-size: 10px;">委任</a> <a href="../../tags/%E5%BD%B9%E5%89%B2/" style="font-size: 10px;">役割</a> <a href="../../tags/%E6%83%85%E5%A0%B1%E6%8E%A1%E5%8F%96/" style="font-size: 14px;">情報採取</a> <a href="../../tags/%E6%A4%9C%E7%B4%A2/" style="font-size: 10px;">検索</a> <a href="../../tags/%E7%92%B0%E5%A2%83%E7%AE%A1%E7%90%86/" style="font-size: 10px;">環境管理</a> <a href="../../tags/%E9%87%8D%E8%A6%81%E3%81%AA%E5%A4%89%E6%9B%B4%E7%82%B9-%E5%BB%83%E6%AD%A2/" style="font-size: 10px;">重要な変更点 (廃止)</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">カテゴリ</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../categories/Dataflow/">Dataflow</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Dataverse/">Dataverse</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Dynamics-365/">Dynamics 365</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Microsoft-Copilot-Studio/">Microsoft Copilot Studio</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Apps/">Power Apps</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Apps/Canvas-App/">Canvas App</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Apps/Canvas-app/">Canvas app</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Apps/Model-driven-app/">Model-driven app</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Automate/">Power Automate</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Automate/Cloud-flow/">Cloud flow</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Automate/Desktop-flow/">Desktop flow</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Pages/">Power Pages</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Platform/">Power Platform</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/Power-Platform-Admin-Center/">Power Platform Admin Center</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/PowerPlatform/">PowerPlatform</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/powerplatform/">powerplatform</a></li><li class="category-list-item"><a class="category-list-link" href="../../categories/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%AE%E3%81%94%E5%88%A9%E7%94%A8%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/">サポートサービスのご利用について</a></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <a href="https://privacy.microsoft.com/ja-jp/privacystatement" target="_blank" rel=”noopener”>Privacy & Cookies</a> |  
      <a href="https://www.microsoft.com/ja-jp/legal/intellectualproperty/copyright" target="_blank" rel=”noopener”>Terms of use</a> |
      <a href="https://www.microsoft.com/ja-jp/legal/intellectualproperty/trademarks" target="_blank" rel=”noopener”>Trademarks</a> |
      &copy; 2026 Japan Dynamics CRM &amp; Power Platform Support Team<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="../../js/script.js"></script>




  </div>
</body>
</html>